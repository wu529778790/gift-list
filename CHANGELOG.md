# 📝 更新日志

## 🔥 v1.1.0 - Excel导出功能 (2025-12-25)

### ✨ 新增功能

#### 📊 Excel导出
- **双工作表导出**：
  - **礼金明细表**：包含序号、姓名、金额、大写金额、支付方式、备注、时间
  - **统计汇总表**：总人数、总金额、各支付方式统计、事件信息、导出时间

- **智能数据处理**：
  - 自动过滤已作废的记录
  - 中文大写金额转换（如：壹仟贰佰叁拾元整）
  - 按支付方式分类统计

- **专业格式**：
  - 表头加粗、灰色背景
  - 单元格居中对齐
  - 自动列宽调整
  - 宋体字体，适合打印

### 📁 文件变更

#### 新增
- `src/lib/backup.ts` - 添加 `exportExcel()` 方法
  - 使用 `xlsx` 库生成Excel文件
  - 支持双工作表结构
  - 自动下载文件

#### 修改
- `src/app/main/page.tsx` - 更新导出按钮功能
  - 调用 `BackupService.exportExcel()`
  - 传递解密后的礼金数据

- `README.md` - 更新功能说明
  - 添加Excel导出特性介绍
  - 更新使用指南

### 🎯 使用方式

在主界面点击 **"导出Excel"** 按钮，即可下载包含以下内容的Excel文件：

```
礼簿_事件名称_20251225.xlsx
├── 礼金明细表
│   ├── 序号 | 姓名 | 金额 | 金额大写 | 支付方式 | 备注 | 录入时间
│   └── 数据行...
└── 统计汇总表
    ├── 总人数：15人
    ├── 总金额：¥25,800.00（贰万伍仟捌佰元整）
    ├── 支付方式统计
    │   ├── 现金：¥12,000（8笔）
    │   ├── 微信：¥8,800（4笔）
    │   └── 支付宝：¥5,000（3笔）
    └── 事件信息
        ├── 事件名称：张三李四婚礼
        ├── 开始时间：2025-12-25
        ├── 结束时间：2025-12-26
        ├── 记账人：王五
        └── 导出时间：2025-12-25
```

### 💡 技术实现

- **依赖**：已集成 `xlsx` (v0.18.5) 库
- **纯前端**：浏览器端生成Excel，无需后端
- **数据安全**：仅导出已解密的有效数据
- **兼容性**：支持所有现代浏览器

### 🐛 修复

- 修复了导出功能占位符提示
- 优化了文件名处理（自动移除特殊字符）

---

## 📚 历史版本

### v1.0.0 - 基础功能 (2025-12-24)

**核心功能：**
- ✅ 事件管理（创建、登录、密码保护）
- ✅ 礼金录入（姓名、金额、支付方式、备注）
- ✅ 数据展示（主屏12列网格）
- ✅ 副屏投影（实时同步、自动翻页）
- ✅ 打印/PDF（横屏A4、竖排格式）
- ✅ 数据备份（JSON导入导出）
- ✅ 数据安全（AES-256加密、本地存储）

**技术栈：**
- React 18 + TypeScript
- Tailwind CSS
- CryptoJS (加密)
- Vite (构建)
- vite-plugin-singlefile (单文件打包)

---

## 🔮 未来计划

- [ ] 数据统计图表（饼图、柱状图）
- [ ] 多语言支持
- [ ] 云端同步（可选）
- [ ] 数据导出为CSV格式
- [ ] 批量导入功能
- [ ] 数据筛选和搜索

---

## 📝 开发说明

### 提交规范
- `feat:` 新功能
- `fix:` 修复bug
- `style:` 样式修改
- `refactor:` 代码重构
- `docs:` 文档更新

### 发布流程
1. 更新版本号
2. 更新 CHANGELOG.md
3. 更新 README.md
4. 构建测试
5. 创建 Git Tag
6. 发布 Release

---

**感谢使用！🎉**

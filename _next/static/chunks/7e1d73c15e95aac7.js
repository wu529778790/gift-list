(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1457,(e,t,a)=>{t.exports=e.r(79747)},75157,e=>{"use strict";e.s(["Utils",0,{formatCurrency:e=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(e||0),amountToChinese:e=>{if("number"!=typeof e)return"";if(0===e)return"零元整";let t="京亿万仟佰拾兆万仟佰拾亿仟佰拾万仟佰拾元角分",a="",r=e.toString();if(r.indexOf(".")>-1?r=(100*e).toFixed(0):r+="00",r.length>t.length)return"金额过大";t=t.substr(t.length-r.length);for(let e=0;e<r.length;e++){let s=parseInt(r.charAt(e),10);a+="零壹贰叁肆伍陆柒捌玖".charAt(s)+t.charAt(e)}return a.replace(/零(仟|佰|拾|角)/g,"零").replace(/(零)+/g,"零").replace(/零(兆|万|亿|元)/g,"$1").replace(/(兆|亿)万/g,"$1").replace(/(京|兆)亿/g,"$1").replace(/(京)兆/g,"$1").replace(/(亿)万/g,"$1").replace(/(京|兆|亿|仟|佰|拾)(万?)(.)/g,"$1$2$3").replace(/零元/g,"元").replace(/零分/g,"").replace(/零角/g,"零").replace(/元$/g,"元整").replace(/角$/g,"角整")},getCurrentDateTime:()=>{let e=new Date,t=e=>e.toString().padStart(2,"0");return{date:`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}`,time:`${t(e.getHours())}:${t(e.getMinutes())}`}},generateId:()=>Date.now().toString(36)+Math.random().toString(36).substr(2)}])},31925,e=>{"use strict";class t{config;constructor(e){this.config=e}async request(e,t="GET",a){let r=`https://api.github.com/repos/${this.config.owner}/${this.config.repo}/contents/${e}`,s=await fetch(r,{method:t,headers:{Authorization:`token ${this.config.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:a?JSON.stringify(a):void 0});if(!s.ok){let e=await s.text();throw Error(`GitHub Error: ${s.status} - ${e}`)}return s.json()}async testConnection(){try{return(await fetch(`https://api.github.com/repos/${this.config.owner}/${this.config.repo}`,{headers:{Authorization:`token ${this.config.token}`}})).ok}catch{return!1}}async readFile(e){try{let t=await this.request(e);return atob(t.content)}catch{return null}}async writeFile(e,t,a){try{let r=await this.readFile(e).catch(()=>null),s={message:a,content:btoa(unescape(encodeURIComponent(t)))};r&&(s.sha=(await this.request(e)).sha),await this.request(e,"PUT",s)}catch(e){throw console.error("GitHub write failed:",e),e}}async syncEvents(e){await this.writeFile("data/events.json",JSON.stringify(e,null,2),"Update events")}async syncGifts(e,t){await this.writeFile(`data/gifts/${e}.json`,JSON.stringify(t,null,2),`Update gifts for ${e}`)}}e.s(["GitHubService",()=>t])},70307,e=>{"use strict";var t=e.i(36364),a=e.i(249),r=e.i(1457),s=e.i(3809),i=e.i(75157),n=e.i(31925);function l(){let e=(0,r.useRouter)(),[l,c]=(0,a.useState)(!1),[o,d]=(0,a.useState)({name:"",startDate:i.Utils.getCurrentDateTime().date,startTime:"18:00",endDate:i.Utils.getCurrentDateTime().date,endTime:"22:00",password:"123456",theme:"festive",recorder:"",githubSync:!1,githubOwner:"",githubRepo:"",githubToken:""}),h=async t=>{t.preventDefault(),c(!0);try{let t={id:i.Utils.generateId(),name:o.name,startDateTime:`${o.startDate}T${o.startTime}`,endDateTime:`${o.endDate}T${o.endTime}`,passwordHash:s.CryptoService.hash(o.password),theme:o.theme,recorder:o.recorder,createdAt:new Date().toISOString()},a=JSON.parse(localStorage.getItem("giftlist_events")||"[]");if(a.push(t),localStorage.setItem("giftlist_events",JSON.stringify(a)),o.githubSync){let e={owner:o.githubOwner,repo:o.githubRepo,token:o.githubToken};localStorage.setItem("giftlist_github",JSON.stringify(e));let t=new n.GitHubService(e);await t.testConnection()?await t.syncEvents(a):(alert("GitHub 连接失败，将只使用本地存储"),localStorage.removeItem("giftlist_github"))}sessionStorage.setItem("currentEvent",JSON.stringify({event:t,password:o.password,timestamp:Date.now()})),sessionStorage.removeItem("has_redirected"),e.replace("/main")}catch(e){console.error(e),alert("创建失败: "+e)}finally{c(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl p-8 fade-in",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center themed-header",children:"电子礼簿系统"}),(0,t.jsx)("h2",{className:"text-xl font-semibold mb-6 text-center border-b pb-2",children:"创建新事项"}),(0,t.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"事项名称"}),(0,t.jsx)("input",{required:!0,value:o.name,onChange:e=>d({...o,name:e.target.value}),placeholder:"例如: 张三李四新婚之喜",className:"themed-ring"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"开始时间"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"date",required:!0,value:o.startDate,onChange:e=>d({...o,startDate:e.target.value}),className:"themed-ring"}),(0,t.jsx)("input",{type:"time",required:!0,value:o.startTime,onChange:e=>d({...o,startTime:e.target.value}),className:"themed-ring"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"结束时间"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"date",required:!0,value:o.endDate,onChange:e=>d({...o,endDate:e.target.value}),className:"themed-ring"}),(0,t.jsx)("input",{type:"time",required:!0,value:o.endTime,onChange:e=>d({...o,endTime:e.target.value}),className:"themed-ring"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"管理密码"}),(0,t.jsx)("input",{required:!0,type:"password",value:o.password,onChange:e=>d({...o,password:e.target.value}),placeholder:"默认 123456，请牢记，丢失无法找回",className:"themed-ring"})]}),(0,t.jsxs)("details",{className:"group",children:[(0,t.jsx)("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 group-hover:text-gray-900 list-none",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{children:"更多设置"}),(0,t.jsx)("span",{className:"text-lg ml-1 transition-transform transform group-open:rotate-180",children:"▼"})]})}),(0,t.jsxs)("div",{className:"mt-4 p-4 card themed-border space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"界面风格"}),(0,t.jsxs)("select",{value:o.theme,onChange:e=>d({...o,theme:e.target.value}),className:"themed-ring",children:[(0,t.jsx)("option",{value:"festive",children:"喜庆红 (喜事)"}),(0,t.jsx)("option",{value:"solemn",children:"肃穆灰 (白事)"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"为不同性质的事项选择合适的界面配色风格。"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"记账人"}),(0,t.jsx)("input",{value:o.recorder,onChange:e=>d({...o,recorder:e.target.value}),placeholder:"记账人 (例如: 王五，选填)",className:"themed-ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:o.githubSync,onChange:e=>d({...o,githubSync:e.target.checked})}),(0,t.jsx)("span",{className:"font-medium",children:"启用 GitHub 云端同步"})]}),o.githubSync&&(0,t.jsxs)("div",{className:"mt-3 space-y-3 card p-4",children:[(0,t.jsx)("p",{className:"text-sm text-blue-800",children:"数据将加密存储在你的 GitHub 仓库中，支持多设备同步"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GitHub 用户名"}),(0,t.jsx)("input",{required:o.githubSync,placeholder:"owner",value:o.githubOwner,onChange:e=>d({...o,githubOwner:e.target.value}),className:"themed-ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"仓库名"}),(0,t.jsx)("input",{required:o.githubSync,placeholder:"repo",value:o.githubRepo,onChange:e=>d({...o,githubRepo:e.target.value}),className:"themed-ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Personal Access Token"}),(0,t.jsx)("input",{required:o.githubSync,type:"password",placeholder:"ghp_...",value:o.githubToken,onChange:e=>d({...o,githubToken:e.target.value}),className:"themed-ring"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"需要 repo 权限。数据将保存在 data/ 目录下。"})]})]})]})]}),(0,t.jsx)("button",{type:"submit",disabled:l,className:"w-full themed-button-primary p-3 rounded-lg transition duration-300 font-bold hover-lift",children:l?"创建中...":"创建并进入"})]})]})})}e.s(["default",()=>l])}]);